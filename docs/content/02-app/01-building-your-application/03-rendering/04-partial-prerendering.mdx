---
title: éƒ¨åˆ†é¢„æ¸²æŸ“
description: äº†è§£å¦‚ä½•å°†é™æ€å’ŒåŠ¨æ€æ¸²æŸ“çš„ä¼˜ç‚¹ä¸éƒ¨åˆ†é¢„æ¸²æŸ“ç»“åˆèµ·æ¥ã€‚
---

éƒ¨åˆ†é¢„æ¸²æŸ“(PPR) ä½¿æ‚¨èƒ½å¤Ÿåœ¨åŒä¸€è·¯ç”±ä¸­å°†é™æ€å’ŒåŠ¨æ€ç»„ä»¶ç»„åˆã€‚

åœ¨æ„å»ºè¿‡ç¨‹ä¸­ï¼ŒNext.js ä¼šå°½å¯èƒ½å¤šåœ°é¢„æ¸²æŸ“è·¯ç”±ã€‚å¦‚æœæ£€æµ‹åˆ°[åŠ¨æ€](/docs/content/app/building-your-application/rendering/server-components#dynamic-rendering)ä»£ç ï¼ˆä¾‹å¦‚ä»ä¼ å…¥çš„è¯·æ±‚ä¸­è¯»å–çš„ï¼‰,åˆ™å¯ä»¥ä½¿ç”¨[React Suspense](https://react.dev/reference/react/Suspense)è¾¹ç•ŒåŒ…è£…ç›¸å…³çš„ç»„ä»¶ã€‚ç„¶åï¼ŒSuspense è¾¹ç•Œå¤‡ç”¨å°†è¢«åŒ…å«åœ¨é¢„æ¸²æŸ“çš„ HTML ä¸­ã€‚

> **æ³¨æ„:** éƒ¨åˆ†é¢„æ¸²æŸ“æ˜¯ä¸€é¡¹**å®éªŒæ€§** åŠŸèƒ½å¹¶ä¸”å¯èƒ½ä¼šæ”¹å˜ã€‚å®ƒè¿˜ä¸èƒ½ç”¨äºç”Ÿäº§ä½¿ç”¨ã€‚

<img
  alt="Partially Prerendered Product Page showing static nav and product information, and dynamic cart and recommended products"
  src="/thinking-in-ppr.avif"
  width="100%"
  height="auto"
/>

> **ğŸ¥ è§‚çœ‹:** ä¸ºä»€ä¹ˆä½¿ç”¨ PPR ä»¥åŠå®ƒçš„å·¥ä½œåŸç† â†’ [YouTube (10 åˆ†é’Ÿ)](https://www.youtube.com/watch?v=MTcPrTIBkpA).

## èƒŒæ™¯

PPR ä½¿ Next.js æœåŠ¡å™¨èƒ½å¤Ÿç«‹å³å‘é€é¢„æ¸²æŸ“çš„å†…å®¹ã€‚

ä¸ºäº†é˜²æ­¢å®¢æˆ·ç«¯åˆ°æœåŠ¡å™¨çš„ç€‘å¸ƒæµï¼ŒåŠ¨æ€ç»„ä»¶åœ¨æä¾›åˆå§‹é¢„æ¸²æŸ“çš„åŒæ—¶å¼€å§‹å¹¶è¡Œçš„ä»æœåŠ¡å™¨æµå¼ä¼ è¾“ã€‚è¿™ç¡®ä¿äº†åœ¨æµè§ˆå™¨åŠ è½½å®Œå®¢æˆ·ç«¯ JavaScript ä¹‹å‰åŠ¨æ€ç»„ä»¶å°±èƒ½å¤Ÿå¼€å§‹æ¸²æŸ“ã€‚

ä¸ºäº†é˜²æ­¢ä¸ºæ¯ä¸ªåŠ¨æ€ç»„ä»¶åˆ›å»ºè®¸å¤š HTTP è¯·æ±‚ï¼ŒPPR èƒ½å¤Ÿå°†é™æ€é¢„æ¸²æŸ“å’ŒåŠ¨æ€ç»„ä»¶ç»„åˆåˆ°å•ä¸ª HTTP è¯·æ±‚ä¸­ã€‚è¿™ç¡®ä¿äº†æ¯ä¸ªåŠ¨æ€ç»„ä»¶ä¸éœ€è¦å¤šæ¬¡ç½‘ç»œå¾€è¿”ã€‚

## ä½¿ç”¨éƒ¨åˆ†é¢„æ¸²æŸ“

### é€æ­¥é‡‡ç”¨ (ç‰ˆæœ¬ 15)

åœ¨ Next.js 15 ä¸­, æ‚¨å¯ä»¥é€šè¿‡åœ¨`next.config.js`ä¸­å°†[`ppr`](/docs/content/app/api-reference/next-config-js/ppr)é€‰é¡¹è®¾ç½®ä¸º`incremental`å¹¶ä¸”åœ¨æ–‡ä»¶é¡¶éƒ¨å¯¼å‡º`experimental_ppr` [è·¯ç”±é…ç½®é€‰é¡¹](/docs/content/app/api-reference/file-conventions/route-segment-config)ä»¥åœ¨[layouts](/docs/content/app/building-your-application/routing/layouts-and-templates) å’Œ [pages](/docs/content/app/building-your-application/routing/pages)ä¸­é€æ­¥é‡‡ç”¨éƒ¨åˆ†é¢„æ¸²æŸ“ã€‚

```ts filename="next.config.ts" switcher
import type { NextConfig } from "next";

const nextConfig: NextConfig = {
  experimental: {
    ppr: "incremental",
  },
};

export default nextConfig;
```

```js filename="next.config.js" switcher
/** @type {import('next').NextConfig} */
const nextConfig = {
  experimental: {
    ppr: "incremental",
  },
};

module.exports = nextConfig;
```

```tsx filename="app/page.tsx" switcher
import { Suspense } from "react"
import { StaticComponent, DynamicComponent, Fallback } from "@/app/ui"

export const experimental_ppr = true

export default function Page() {
  return {
     <>
      <StaticComponent />
      <Suspense fallback={<Fallback />}>
        <DynamicComponent />
      </Suspense>
     </>
  };
}
```

```jsx filename="app/page.js" switcher
import { Suspense } from "react"
import { StaticComponent, DynamicComponent, Fallback } from "@/app/ui"

export const experimental_ppr = true

export default function Page() {
  return {
     <>
      <StaticComponent />
      <Suspense fallback={<Fallback />}>
        <DynamicComponent />
      </Suspense>
     </>
  };
}
```

> **æ‚¨éœ€è¦çŸ¥é“**:
>
> - æ²¡æœ‰`experimental_ppr`çš„è·¯ç”±å°†é»˜è®¤ä¸º`false`å¹¶ä¸”ä¸èƒ½ä½¿ç”¨ PPR é¢„æ¸²æŸ“ã€‚ä½ éœ€è¦æ˜ç¡®åœ°ä¸ºæ¯ä¸ªè·¯ç”±é€‰æ‹©åŠ å…¥ PPRã€‚
> - `experimental_ppr`å°†åº”ç”¨åˆ°è·¯ç”±æ®µçš„æ‰€æœ‰å­æ®µ, åŒ…æ‹¬åµŒå¥—çš„ layouts å’Œ pagesã€‚æ‚¨ä¸éœ€è¦å°†å®ƒæ·»åŠ åˆ°æ¯ä¸ªæ–‡ä»¶ï¼Œåªéœ€è¦åœ¨è·¯ç”±çš„é¡¶éƒ¨æ®µæ·»åŠ å³å¯ã€‚
> - è¦ä¸ºå­ç»„ä»¶ç¦ç”¨ PPR, æ‚¨å¯ä»¥åœ¨å­—æ®µä¸­å°† `experimental_ppr` è®¾ç½®ä¸º `false`ã€‚

### å¯ç”¨ PPR (ç‰ˆæœ¬ 14)

å¯¹äºç‰ˆæœ¬ 14, æ‚¨å¯ä»¥é€šè¿‡åœ¨`next.config.js`æ–‡ä»¶ä¸­æ·»åŠ [`ppr`](/docs/content/app/api-reference/next-config-js/ppr)é€‰é¡¹æ¥å¯ç”¨å®ƒã€‚è¿™å°†åº”ç”¨äºåº”ç”¨ç¨‹åºä¸­çš„æ‰€æœ‰è·¯ç”±ï¼š

```ts filename="next.config.ts" switcher
import type { NextConfig } from "next";

const nextConfig: NextConfig = {
  experimental: {
    ppr: true,
  },
};

export default nextConfig;
```

```js filename="next.config.js" switcher
/** @type {import('next').NextConfig} */
const nextConfig = {
  experimental: {
    ppr: true,
  },
};

module.exports = nextConfig;
```

## åŠ¨æ€ç»„ä»¶

å½“åœ¨`next build`æœŸé—´ä¸ºè·¯ç”±åˆ›å»ºé¢„æ¸²æŸ“æ—¶ï¼ŒNext.js éœ€è¦ä½¿ç”¨ React Suspense åŒ…è£¹åŠ¨æ€å‡½æ•°ã€‚ç„¶å`fallback`å°†åŒ…å«åœ¨é¢„æ¸²æŸ“ä¸­ã€‚

ä¾‹å¦‚, ä½¿ç”¨å‡½æ•°ï¼Œä¾‹å¦‚ï¼š`cookies()` æˆ– `headers()`:

```jsx filename="app/user.js" switcher
import { cookies } from "next/headers";

export function User() {
  const session = cookies().get("session")?.value;
  return "...";
}
```

```tsx filename="app/user.tsx" switcher
import { cookies } from "next/headers";

export function User() {
  const session = cookies().get("session")?.value;
  return "...";
}
```

è¯¥ç»„ä»¶éœ€è¦æŸ¥çœ‹ä¼ å…¥çš„è¯·æ±‚ä»¥è¯»å– cookieã€‚è¦å°†å…¶ä¸ PPR ä¸€èµ·ä½¿ç”¨, æ‚¨åº”è¯¥ä½¿ç”¨ Suspense åŒ…è£¹è¿™ä¸ªç»„ä»¶:

```tsx filename="app/page.tsx" switcher
import { Suspense } from "react";
import { User, AvatarSkeleton } from "./user";

export const experimental_ppr = true;

export default function Page() {
  return (
    <section>
      <h1>This will be prerendered</h1>
      <Suspense fallback={<AvatarSkeleton />}>
        <User />
      </Suspense>
    </section>
  );
}
```

```jsx filename="app/page.js" switcher
import { Suspense } from "react";
import { User, AvatarSkeleton } from "./user";

export const experimental_ppr = true;

export default function Page() {
  return (
    <section>
      <h1>This will be prerendered</h1>
      <Suspense fallback={<AvatarSkeleton />}>
        <User />
      </Suspense>
    </section>
  );
}
```

ç»„ä»¶åªåœ¨è®¿é—®å€¼æ—¶æ‰é€‰æ‹©åŠ¨æ€æ¸²æŸ“ã€‚

ä¾‹å¦‚, å¦‚æœæ‚¨æ­£ä»ä¸€ä¸ª`page`è¯»å–`searchParams`æ—¶, æ‚¨å¯ä»¥å°†è¯¥å€¼ä½œä¸ºå±æ€§ä¼ é€’ç»™å¦ä¸€ä¸ªç»„ä»¶:

```tsx filename="app/page.tsx" switcher
import { Table } from "./table";

export default function Page({
  searchParams,
}: {
  searchParams: { sort: string };
}) {
  return (
    <section>
      <h1>This will be prerendered</h1>
      <Table searchParams={searchParams} />
    </section>
  );
}
```

```jsx filename="app/page.js" switcher
import { Table } from "./table";

export default function Page({ searchParams }) {
  return (
    <section>
      <h1>This will be prerendered</h1>
      <Table searchParams={searchParams} />
    </section>
  );
}
```

åœ¨ table ç»„ä»¶å†…éƒ¨, è®¿é—®`searchParams`ä¸­çš„å€¼å°†ä½¿ç»„ä»¶åŠ¨æ€è¿è¡Œï¼š

```tsx filename="app/table.tsx" switcher
export function Table({ searchParams }: { searchParams: { sort: string } }) {
  const sort = searchParams.sort === "true";
  return "...";
}
```

```jsx filename="app/table.js" switcher
export function Table({ searchParams }: { searchParams: { sort: string } }) {
  const sort = searchParams.sort === "true";
  return "...";
}
```
